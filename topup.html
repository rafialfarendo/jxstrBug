<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Top Up ‚Äî JxstrBug V6</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#000;
  --card:#0d0d0d;
  --accent:#ff4d4d;
  --muted:#ffbcbc;
  --muted-2:#ffc7c7;
  --border: rgba(255,58,58,0.2);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
    margin:0;
    background:var(--bg);
    color:var(--muted);
    font-family:'Orbitron',sans-serif;
    -webkit-tap-highlight-color: transparent;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
}
.container{
  max-width:430px;
  margin:0 auto;
  padding:18px;
  padding-top:84px;
  padding-bottom:5px;
}
.header{
  position:fixed;
  left:0; right:0; top:0;
  height:64px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:12px 16px;
  background:var(--bg);
  border-bottom:1px solid rgba(255,58,58,0.12);
  z-index:60;
}
.header .left, .header .right{display:flex; align-items:center; gap:12px}
.back-btn{
  width:44px; height:44px; border-radius:12px;
  border:1px solid rgba(255,58,58,0.12);
  display:flex; align-items:center; justify-content:center;
  cursor:pointer;
  user-select:none;
}
.header-title{
  color:var(--accent);
  font-size:20px;
  letter-spacing:0.6px;
}
.card{
  background:var(--card);
  border:1px solid rgba(255,58,58,0.12);
  border-radius:18px;
  padding:18px;
  margin-bottom:18px;
  box-shadow: inset 0 -6px 18px rgba(0,0,0,0.45);
}
.topup-card{
  display:flex;
  gap:16px;
  align-items:center;
}
.icon-circle{
  width:76px; height:76px; border-radius:16px;
  display:flex; align-items:center; justify-content:center;
  background: rgba(255,58,58,0.04);
  border:2px solid rgba(255,58,58,0.06);
  flex:0 0 76px;
}
.icon-circle svg{ width:44px; height:44px; stroke:var(--muted); fill:none; stroke-width:1.8; }
.titles{
  flex:1;
}
.titles h1{
  margin:0;
  font-size:24px;
  color:var(--muted);
  font-style: normal;
  transform: none;
}
.titles p{ margin:6px 0 0; font-size:12.5px; color:var(--muted-2); font-style:normal; transform:none; }

.info-card .info-head{
  display:flex; gap:12px; align-items:center;
}
.info-icon{
  width:44px; height:44px; border-radius:12px;
  display:flex; align-items:center; justify-content:center;
  background: rgba(255,58,58,0.04);
  border:1px solid rgba(255,58,58,0.06);
  font-size:20px;
  font-weight:700;
  color:var(--muted);
  line-height:1;
}
.info-icon .qm{
  display:inline-block;
  font-family: 'Orbitron', Arial, sans-serif;
  font-size:20px;
  font-weight:700;
  color:var(--muted);
  line-height:1;
}
.info-icon svg{ width:22px; height:22px; stroke:var(--muted); fill:none; stroke-width:1.6; }
.info-text{ margin-top:12px; font-size:13px; color:var(--muted-2); line-height:1.45; }
.redeem-card .redeem-head{
  display:flex; align-items:center; gap:12px; margin-bottom:12px;
}
.redeem-input{
  width:100%;
  padding:12px 14px;
  border-radius:12px;
  background: rgba(255,77,77,0.03);
  border:1px solid rgba(255,58,58,0.12);
  color:var(--muted);
  font-family:'Orbitron',sans-serif;
  font-size:13px;
  outline:none;
}
.redeem-row{ display:flex; gap:10px; margin-top:12px; align-items:center; }
.btn{
  padding:11px 14px;
  border-radius:12px;
  border:1px solid rgba(255,58,58,0.12);
  background:transparent;
  color:var(--muted);
  cursor:pointer;
  font-family:'Orbitron',sans-serif;
  font-size:13px;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}
.btn:hover {
  background: rgba(255,77,77,0.05);
}
.btn.primary{
  background: rgba(255,77,77,0.08);
  color:var(--accent);
  border:1px solid rgba(255,58,58,0.18);
  width: 100%;
}
.btn.primary:hover {
  background: rgba(255,77,77,0.12);
}
.small{ font-size:12px; color:var(--muted-2); }
.sep{ height:12px }

/* Contact Card Styles */
.contact-card {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.contact-title {
  font-size: 16px;
  color: var(--muted);
  margin: 0 0 4px 0;
  display: flex;
  align-items: center;
  gap: 8px;
}

.contact-subtitle {
  font-size: 12px;
  color: var(--muted-2);
  margin: 0 0 8px 0;
}

.contact-buttons {
  display: flex;
  gap: 10px;
}

.contact-btn {
  flex: 1;
  padding: 12px 14px;
  border-radius: 12px;
  border: 1px solid rgba(255,58,58,0.18);
  background: rgba(255,77,77,0.08);
  color: var(--accent);
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  font-size: 13px;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.contact-btn:hover {
  background: rgba(255,77,77,0.12);
  border-color: rgba(255,58,58,0.24);
}

/* Price List Styles */
.price-list {
  margin-top: 16px;
  border-top: 1px solid rgba(255,58,58,0.08);
  padding-top: 16px;
}

.price-list-title {
  font-size: 14px;
  color: var(--muted);
  margin: 0 0 12px 0;
  display: flex;
  align-items: center;
  gap: 8px;
}

/* Dihapus pseudo-element dengan "üí∞" */
.price-list-title::before {
  content: none;
}

.price-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 0;
  border-bottom: 1px solid rgba(255,58,58,0.05);
}

.price-item:last-child {
  border-bottom: none;
}

.coin-amount {
  font-size: 13px;
  color: var(--muted);
  display: flex;
  align-items: center;
  gap: 6px;
}

/* Mengganti "ü™ô" dengan titik bulat merah */
.coin-amount::before {
  content: "‚óè";
  font-size: 14px;
  color: var(--accent);
}

.price-value {
  font-size: 13px;
  color: var(--accent);
  font-weight: 700;
}

.price-item.featured {
  background: rgba(255,77,77,0.03);
  margin: 0 -12px;
  padding: 12px;
  border-radius: 8px;
  border: 1px solid rgba(255,58,58,0.1);
}

.price-item.featured .coin-amount {
  color: var(--accent);
  font-weight: 700;
}

.price-item.featured .coin-amount::before {
  content: "(VIP)";
}

.toast{
  position:fixed;
  left:50%;
  transform:translateX(-50%) translateY(60px);
  bottom:96px;
  background: rgba(255,77,77,0.12);
  border:1px solid rgba(255,77,77,0.18);
  color:var(--muted);
  padding:10px 16px;
  border-radius:10px;
  font-size:13px;
  opacity:0; pointer-events:none;
  transition:opacity .28s, transform .28s;
  z-index:120;
}
.toast.show{ opacity:1; transform:translateX(-50%) translateY(0); pointer-events:auto; }
@media (max-width:400px){
  .icon-circle{ width:64px; height:64px; border-radius:14px; flex:0 0 64px }
  .titles h1{ font-size:20px }
  .titles p{ font-size:12px }
  .header-title{ font-size:18px }
  .contact-buttons {
    flex-direction: column;
  }
}
</style>
</head>
<body>
  <div class="header" role="banner">
    <div class="left">
      <div class="back-btn" id="backBtn" title="Back" aria-label="Back">
        <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" fill="none" stroke-width="1.6" style="color:var(--muted)"><path d="M15 6 L9 12 L15 18" stroke-linecap="round" stroke-linejoin="round"></path></svg>
      </div>
    </div>

    <div class="header-title">Top Up Jcoins</div>

    <div class="right">
      <!-- profile button removed as requested -->
    </div>
  </div>

  <main class="container" role="main">

    <!-- Top Up Coins card -->
    <section class="card topup-card" aria-labelledby="topupTitle">
      <div class="icon-circle" aria-hidden="true">
        <svg viewBox="0 0 24 24" width="44" height="44" aria-hidden="true" focusable="false">
          <circle cx="12" cy="12" r="10" stroke="currentColor" fill="none" stroke-width="1.8"/>
          <text x="12" y="16" text-anchor="middle" fill="currentColor" font-family="Arial, sans-serif" font-size="12" font-weight="bold">C</text>
        </svg>
      </div>
      <div class="titles">
        <h1 id="topupTitle">Top Up Coins</h1>
        <p>Redeem codes to add coins to your account</p>
      </div>
      <div style="flex:0 0 44px;">
        <!-- small info button removed as requested -->
      </div>
    </section>

    <!-- How to Top Up card -->
    <section class="card info-card" aria-labelledby="howTitle">
      <div class="info-head">
        <div class="info-icon" aria-hidden="true">
          <span class="qm" aria-hidden="true">?</span>
        </div>
        <div>
          <h2 id="howTitle" style="margin:0;font-size:16px;color:var(--muted)">How to Top Up</h2>
          <div class="small">Quick guide</div>
        </div>
      </div>
      <div class="info-text">
        To top up your coins, you need a redemption code. Contact the admin to get a code. You can also use live chat or contact links in the information menu.
      </div>
    </section>

    <!-- Contact Top Up Card -->
    <section class="card contact-card" aria-labelledby="contactTitle">
      <div>
        <h3 id="contactTitle" class="contact-title">Contact Top Up Here</h3>
        <p class="contact-subtitle">Contact admin via Telegram or Form Buy</p>
      </div>
      
      <div class="contact-buttons">
        <button class="contact-btn" id="telegramBtn">
          <span></span> Telegram
        </button>
        <button class="contact-btn" id="whatsappBtn">
          <span></span> FormBuy
        </button>
      </div>
      
      <div class="price-list">
        <h4 class="price-list-title">Pricelist Coins/ Indonesian currency</h4>
        
        <div class="price-item">
          <span class="coin-amount">7 coins + ( 1 sender )</span>
          <span class="price-value">Rp 10.000</span>
        </div>
        
        <div class="price-item">
          <span class="coin-amount">25 coins + ( 5 sender )</span>
          <span class="price-value">Rp 25.000</span>
        </div>
        
        <div class="price-item">
          <span class="coin-amount">50 coins + ( 15 sender )</span>
          <span class="price-value">Rp 35.000</span>
        </div>
        
        <div class="price-item featured">
          <span class="coin-amount">Unlimited Coin+Sender</span>
          <span class="price-value">Rp50.000</span>
        </div>
      </div>
    </section>

    <!-- Redemption Code card -->
    <section class="card redeem-card" aria-labelledby="redeemTitle">
      <div class="redeem-head">
        <div>
          <h3 id="redeemTitle" style="margin:0;font-size:16px;color:var(--muted)">Redemption Code</h3>
          <div class="small">Enter your redemption code below</div>
        </div>
      </div>

      <div class="sep"></div>

      <input id="codeInput" class="redeem-input" type="text" placeholder="Enter your redemption code" aria-label="Redemption code input">

      <div class="redeem-row">
        <button class="btn primary" id="redeemBtn">Redeem Code</button>
      </div>

      <div class="sep"></div>
      <div class="small">If you don't have a code, contact admin or use the information menu.</div>
    </section>

  </main>

  <div id="toast" class="toast" role="status" aria-live="polite">Message</div>

<script>
(function(){
  // === KONFIGURASI JSONBIN.IO ===
  const JSONBIN_CONFIG = {
    BIN_ID: '692f3463d0ea881f400e6c43', // Ganti dengan Bin ID Anda
    API_KEY: '$2a$10$Mm.UsarcYYOz3juNbIR6jO2LSmS.xRRhuDV16tt/T7ajEemkYN6.W', // Ganti dengan API Key Anda
  };
  
  const API_URL = `https://api.jsonbin.io/v3/b/${JSONBIN_CONFIG.BIN_ID}`;
  
  const redeemBtn = document.getElementById('redeemBtn');
  const codeInput = document.getElementById('codeInput');
  const toast = document.getElementById('toast');
  const backBtn = document.getElementById('backBtn');
  const telegramBtn = document.getElementById('telegramBtn');
  const whatsappBtn = document.getElementById('whatsappBtn');

  function showToast(msg){
    toast.textContent = msg;
    toast.classList.add('show');
    clearTimeout(toast._t);
    toast._t = setTimeout(()=> toast.classList.remove('show'), 2800);
  }

  // Fungsi cek code ke JSONBin
  async function checkCodeFromJSONBin(code) {
    try {
      // Ambil data dari JSONBin
      const response = await fetch(`${API_URL}/latest`, {
        headers: {
          'X-Master-Key': JSONBIN_CONFIG.API_KEY
        }
      });
      
      if (!response.ok) throw new Error('Failed to fetch');
      
      const data = await response.json();
      const codes = data.record.codes || [];
      
      // Cari code yang sesuai
      const foundCode = codes.find(c => c.code === code.toUpperCase());
      
      if (!foundCode) {
        return { valid: false, message: 'Invalid code. Contact admin.' };
      }
      
      if (!foundCode.valid || foundCode.used) {
        return { valid: false, message: 'Code already used or invalid.' };
      }
      
      // Mark code as used
      const codeIndex = codes.findIndex(c => c.code === code.toUpperCase());
      if (codeIndex !== -1) {
        codes[codeIndex].used = true;
        codes[codeIndex].usedAt = new Date().toISOString();
        
        // Update ke JSONBin
        await fetch(API_URL, {
          method: 'PUT',
          headers: {
            'X-Master-Key': JSONBIN_CONFIG.API_KEY,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ codes: codes })
        });
      }
      
      const coins = foundCode.coins || 10;
      return { 
        valid: true, 
        message: `Code redeemed ‚Äî ${coins} coins added`,
        coins: coins 
      };
      
    } catch (error) {
      console.error('JSONBin error:', error);
      return { valid: false, message: 'Server error. Try again later.' };
    }
  }

  redeemBtn.addEventListener('click', async function(){
    const code = codeInput.value.trim();
    
    if(!code){
      showToast('Please enter a redemption code');
      return;
    }
    
    // Tampilkan loading
    const originalText = redeemBtn.textContent;
    redeemBtn.textContent = 'Checking...';
    redeemBtn.disabled = true;
    
    // Cek code dari JSONBin
    const result = await checkCodeFromJSONBin(code);
    
    // Reset button
    redeemBtn.textContent = originalText;
    redeemBtn.disabled = false;
    
    if(result.valid){
      showToast(result.message);
      codeInput.value = '';
    } else {
      showToast(result.message);
    }
  });

  backBtn.addEventListener('click', function(){
  window.location.href = 'index.html';
});

  telegramBtn.addEventListener('click', function(){
    showToast('Opening Telegram...');
      window.location.href = 'https://t.me/kimpiwww';
  });

  whatsappBtn.addEventListener('click', function(){
    showToast('Coming Soon!');
  });

  codeInput.addEventListener('keydown', function(e){
    if(e.key === 'Enter') redeemBtn.click();
  });
})();
</script>
</body>
</html>
